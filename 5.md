# 5.Oracleインスタンスの管理

## 1.インスタンス
### 1.インスタンスとは
* OracleDBのデータ処理の中心となる常駐部分
  * OracleDBを使用するにはインスタンスを起動しておく必要がある
* SGA:SystemGlobalAreaとバックグラウンドプロセスから成る
* **1つのインスタンスは1組のDBファイルに対応**
  * 1つのインスタンス<->2組以上のDBファイルはダメ
  * 2つ以上のインスタンス<->2組以上のDBファイルもダメ
  * インスタンスとDBファイル群は同じコンピュータ上に配置

### 2.バックグラウンドプロセス
* インスタンス起動時にSGAのメモリ割り当てと併せて起動されるいくつかのプロセスの総称
* 特定の接続に限定されない、OracleDB全体の処理を担う
    * DBwn:データベースライター
      * DBバッファキャッシュ内の更新済みブロックをデータファイルに書き込む
    * LGWR:ログライター
      * REDOログバッファのREDOデータをREDOログファイルに書き出す
    * CKPT:チェックポイント
      * DBWnに対して、DBバッファキャッシュ内の更新済みブロックをデータファイルに書き込む支持を出す
      * 制御ファイルにチェックポイント情報を書き込む
    * SMON:システムモニタ
      * インスタンスが異常終了した場合、次回インスタンス起動時にDBファイルの整合性を復旧する処理を実行する
    * PMON:プロセスモニタ
      * プロセスが異常終了した場合、そのプロセスが使用していた様々なデータやリソースの後処理を実行する
    * MMON:管理モニタ
      * 性能分析などで仕様される統計情報を定期収集する
    * ARCn:アーカイバ
      * ログスイッチの発生後、REDOログファイルのREDOデータをアーカイブログファイルとしてコピーする

### 3.SGA(システムグローバル領域)
* インスタンス起動時に割り当てられるメモリ領域
* プロセス間で共有されるデータが保管される
* コンポーネント：SGA内にある、用途に応じたいくつかのメモリ領域
  * DBバッファキャッシュ
    * データファイルから読み込んだブロックをキャッシュ
    * 更新済みブロックを一時的に保管（バッファ）
  * 共有プール
    * 解析済みのSQLやデータディクショナリなどの情報をキャッシュする
  * REDOログバッファ
    * REDOログファイルに書き込む前のREDOデータを一時的に保管する
  * Javaプール
    * Javaで記述されたストアドプログラムの実行に使用される
  * ラージプール
    * バックアップや並列処理などの作業領域として使用される

### 4.DBバッファキャッシュ
* ブロックの読み出しと書き込みの性能を向上させるためのメモリ領域
* DBバッファキャッシュを介して、ブロックの読み出し/書き込みを行う
  * キャッシュ機能
    * データファイルから参照を行う際、一旦データファイルからSGA内のDBバッファキャッシュにブロックを保管する
    * 次に同じブロックを読み出す際、DBバッファキャッシュから読み出す
  * バッファ機能
    * Oracleで更新処理を行う際、DBバッファキャッシュにあるブロックが更新される
      * メモリ上のブロックだけを更新するため、処理が高速
      * 同一ブロックを複数回更新する際、データファイルへの書き込みを1回に減らせる
      * DBWn:データベースライターにより後でデータファイルに書き込まれる
### 5.REDOログバッファ
* 更新時、データファイルに書き出される前（DBバッファキャッシュに書き込まれた後）でインスタンス障害が発生すると、ブロックの更新が失われてしまう
* これを防ぐため、REDOデータ：更新履歴を生成する
* 更新を確定したタイミング(=トランザクションをコミットしたタイミング)でREDOログファイルに書き込まれる
* 書き込む前のREDOデータを一時保管するメモリ領域：REDOログバッファ

### 6.共有プール
* 性能向上のため様々な情報をキャッシュするメモリ領域
  * 解析済みSQLの情報：
    * 同一のSQLを実行する場合、共有プールから使用することで、時間短縮/負荷低減
    * データディクショナリの情報：
      * Oracleは様々な処理でデータディクショナリ：DBの内部管理情報に繰り返しアクセスするため、
      * データディクショナリの情報をキャッシュすることで性能向上
### 7.PGA(プログラムグローバル領域)

## 2.インスタンスの起動/停止
### 1.インスタンスの起動
### 2.初期化パラメータ
### 3.初期化パラメータファイル
### 4.インスタンスの停止

## 3.メモリコンポーネントの管理
### 1.Oracleのメモリサイズ自動調整機能
### 2.自動メモリ管理
### 3.自動共有メモリ管理
### 4.自動PGAメモリ管理